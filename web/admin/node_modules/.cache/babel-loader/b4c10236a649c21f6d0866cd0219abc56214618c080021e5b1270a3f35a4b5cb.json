{"ast":null,"code":"const columns = [{\n  title: 'ID',\n  dataIndex: 'id',\n  width: '10%',\n  key: 'id',\n  align: 'center'\n}, {\n  title: '分类名',\n  dataIndex: 'name',\n  width: '20%',\n  key: 'name',\n  align: 'center'\n}, {\n  title: '操作',\n  width: '30%',\n  key: 'action',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'action'\n  }\n}];\nexport default {\n  data() {\n    return {\n      pagination: {\n        pageSizeOptions: ['5', '10', '20'],\n        defaultCurrent: 1,\n        defaultPageSize: 5,\n        total: 0,\n        showSizeChanger: true,\n        showTotal: total => `共${total}条`\n      },\n      cateList: [],\n      columns,\n      queryParam: {\n        pagesize: 5,\n        pagenum: 1\n      },\n      newcate: {\n        name: ''\n      },\n      cateinfo: {\n        id: 0,\n        catename: ''\n      },\n      addCateRules: {\n        name: [{\n          required: true,\n          message: '请输入分类名',\n          trigger: 'blur'\n        }]\n      },\n      editCateRules: {\n        name: [{\n          required: true,\n          message: '请输入分类名',\n          trigger: 'blur'\n        }]\n      },\n      addCateVisible: false,\n      editCateVisible: false,\n      visible: false\n    };\n  },\n  created() {\n    this.getCateList();\n  },\n  methods: {\n    // 获取分类列表\n    async getCateList() {\n      const {\n        data: res\n      } = await this.$http.get('categories', {\n        params: {\n          pagesize: this.queryParam.pagesize,\n          pagenum: this.queryParam.pagenum\n        }\n      });\n      if (res.status !== 200) return this.$message.error(res.message);\n      this.cateList = res.data;\n      this.pagination.total = res.total;\n    },\n    // 修改分页时触发\n    handleTableChange(pagination, filters, sorter) {\n      const pager = {\n        ...this.pagination\n      };\n      pager.current = pagination.current;\n      pager.pageSize = pagination.pageSize;\n      this.queryParam.pagesize = pagination.pageSize;\n      this.queryParam.pagenum = pagination.current;\n      if (pagination.pageSize !== this.pagination.pageSize) {\n        this.queryParam.pagenum = 1;\n        pager.current = 1;\n      }\n      this.pagination = pager;\n      this.getCateList();\n    },\n    // 删除分类\n    deleteCate(id) {\n      this.$confirm({\n        title: '确定删除该用分类吗？',\n        content: '一旦删除，无法恢复',\n        onOk: async () => {\n          const {\n            data: res\n          } = await this.$http.delete(`category/${id}`);\n          if (res.status !== 200) return this.$message.error(res.message);\n          this.$message.success('删除成功');\n          this.getCateList();\n        },\n        onCancel: async () => {\n          this.$message.info('已取消删除');\n        }\n      });\n    },\n    // 新增分类\n    addCateOk() {\n      this.$refs.addCateRef.validate(async valid => {\n        if (!valid) return this.$message.error('参数不符合要求，请重新输入');\n        const {\n          data: res\n        } = await this.$http.post('/cate/add', {\n          name: this.newcate.name\n        });\n        if (res.status !== 200) return this.$message.error(res.message);\n        this.addCateVisible = false;\n        this.$message.info('添加分类成功');\n        await this.getCateList();\n      });\n    },\n    addCateCancel() {\n      this.$refs.addCateRef.resetFields();\n      this.addCateVisible = false;\n      this.$message.info('新增分类已取消');\n    },\n    // 编辑用户\n    async editCate(id) {\n      this.editCateVisible = true;\n      const {\n        data: res\n      } = await this.$http.get(`/category/${id}`);\n      if (res.status !== 200) this.$message.error(res.message);\n      this.cateinfo.name = res.data.name;\n      this.cateinfo.id = id;\n    },\n    editCateOk() {\n      this.$refs.editCateRef.validate(async valid => {\n        if (!valid) return this.$message.error('参数不符合要求，请重新输入');\n        const {\n          data: res\n        } = await this.$http.put(`cate/${this.cateinfo.id}`, {\n          name: this.cateinfo.name\n        });\n        if (res.status !== 200) return this.$message.error(res.message);\n        this.editCateVisible = false;\n        this.$message.info('更新分类信息成功');\n        this.getCateList();\n      });\n    },\n    editCateCancel() {\n      this.editCateVisible = false;\n      this.$refs.editCateRef.resetFields();\n      this.$message.info('编辑已取消');\n    }\n  }\n};","map":{"version":3,"names":["columns","title","dataIndex","width","key","align","scopedSlots","customRender","data","pagination","pageSizeOptions","defaultCurrent","defaultPageSize","total","showSizeChanger","showTotal","cateList","queryParam","pagesize","pagenum","newcate","name","cateinfo","id","catename","addCateRules","required","message","trigger","editCateRules","addCateVisible","editCateVisible","visible","created","getCateList","methods","res","$http","get","params","status","$message","error","handleTableChange","filters","sorter","pager","current","pageSize","deleteCate","$confirm","content","onOk","delete","success","onCancel","info","addCateOk","$refs","addCateRef","validate","valid","post","addCateCancel","resetFields","editCate","editCateOk","editCateRef","put","editCateCancel"],"sources":["src/components/category/CateList.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <a-card>\r\n            <a-row :gutter=\"20\">\r\n                <a-col :span=\"4\">\r\n                    <a-button type=\"primary\" @click=\"addCateVisible = true\">新增分类</a-button>\r\n                </a-col>\r\n            </a-row>\r\n\r\n            <a-table :columns=\"columns\" :pagination='pagination' :dataSource=\"cateList\" rowKey=\"id\" bordered\r\n                @change=\"handleTableChange\">\r\n                <template slot=\"action\" slot-scope=\"data\">\r\n                    <div class=\"actionSlot\">\r\n                        <a-button type=\"primary\" icon=\"edit\" style=\"margin-right:15px\"\r\n                            @click=\"editCate(data.id)\">编辑</a-button>\r\n                        <a-button type=\"danger\" icon=\"delete\" style=\"margin-right:15px\"\r\n                            @click=\"deleteCate(data.id)\">删除</a-button>\r\n                    </div>\r\n                </template>\r\n            </a-table>\r\n        </a-card>\r\n        <!--   新增分类区域   -->\r\n        <a-modal closable :visible=\"addCateVisible\" width=\"60%\" title=\"新增分类\" @ok=\"addCateOk\" @cancel=\"addCateCancel\">\r\n            <a-form-model :model=\"newcate\" :rules=\"addCateRules\" ref=\"addCateRef\">\r\n                <a-form-model-item label=\"分类名称\" prop=\"name\">\r\n                    <a-input v-model=\"newcate.name\"></a-input>\r\n                </a-form-model-item>\r\n            </a-form-model>\r\n        </a-modal>\r\n        <!--   编辑分类区域   -->\r\n        <a-modal closable :visible=\"editCateVisible\" width=\"60%\" title=\"编辑分类\" @ok=\"editCateOk\" @cancel=\"editCateCancel\">\r\n            <a-form-model :model=\"cateinfo\" :rules=\"editCateRules\" ref=\"editCateRef\">\r\n                <a-form-model-item label=\"分类名称\" prop=\"name\">\r\n                    <a-input v-model=\"cateinfo.name\"></a-input>\r\n                </a-form-model-item>\r\n            </a-form-model>\r\n        </a-modal>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nconst columns = [\r\n  {\r\n    title: 'ID',\r\n    dataIndex: 'id',\r\n    width: '10%',\r\n    key: 'id',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '分类名',\r\n    dataIndex: 'name',\r\n    width: '20%',\r\n    key: 'name',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '操作',\r\n    width: '30%',\r\n    key: 'action',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'action' }\r\n  }\r\n]\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      pagination: {\r\n        pageSizeOptions: ['5', '10', '20'],\r\n        defaultCurrent: 1,\r\n        defaultPageSize: 5,\r\n        total: 0,\r\n        showSizeChanger: true,\r\n        showTotal: (total) => `共${total}条`\r\n      },\r\n      cateList: [],\r\n      columns,\r\n      queryParam: {\r\n        pagesize: 5,\r\n        pagenum: 1\r\n      },\r\n      newcate: {\r\n        name: ''\r\n      },\r\n      cateinfo: {\r\n        id: 0,\r\n        catename: ''\r\n      },\r\n      addCateRules: {\r\n        name: [\r\n          { required: true, message: '请输入分类名', trigger: 'blur' }\r\n        ]\r\n      },\r\n      editCateRules: {\r\n        name: [\r\n          { required: true, message: '请输入分类名', trigger: 'blur' }\r\n        ]\r\n      },\r\n      addCateVisible: false,\r\n      editCateVisible: false,\r\n      visible: false\r\n    }\r\n  },\r\n  created () {\r\n    this.getCateList()\r\n  },\r\n  methods: {\r\n    // 获取分类列表\r\n    async getCateList () {\r\n      const { data: res } = await this.$http.get('categories', {\r\n        params: {\r\n          pagesize: this.queryParam.pagesize,\r\n          pagenum: this.queryParam.pagenum\r\n        }\r\n      })\r\n      if (res.status !== 200) return this.$message.error(res.message)\r\n      this.cateList = res.data\r\n      this.pagination.total = res.total\r\n    },\r\n    // 修改分页时触发\r\n    handleTableChange (pagination, filters, sorter) {\r\n      const pager = { ...this.pagination }\r\n      pager.current = pagination.current\r\n      pager.pageSize = pagination.pageSize\r\n      this.queryParam.pagesize = pagination.pageSize\r\n      this.queryParam.pagenum = pagination.current\r\n\r\n      if (pagination.pageSize !== this.pagination.pageSize) {\r\n        this.queryParam.pagenum = 1\r\n        pager.current = 1\r\n      }\r\n      this.pagination = pager\r\n      this.getCateList()\r\n    },\r\n    // 删除分类\r\n    deleteCate (id) {\r\n      this.$confirm({\r\n        title: '确定删除该用分类吗？',\r\n        content: '一旦删除，无法恢复',\r\n        onOk: async () => {\r\n          const { data: res } = await this.$http.delete(`category/${id}`)\r\n          if (res.status !== 200) return this.$message.error(res.message)\r\n          this.$message.success('删除成功')\r\n          this.getCateList()\r\n        },\r\n        onCancel: async () => {\r\n          this.$message.info('已取消删除')\r\n        }\r\n      })\r\n    },\r\n    // 新增分类\r\n    addCateOk () {\r\n      this.$refs.addCateRef.validate(async (valid) => {\r\n        if (!valid) return this.$message.error('参数不符合要求，请重新输入')\r\n        const { data: res } = await this.$http.post('/cate/add', {\r\n          name: this.newcate.name\r\n        })\r\n        if (res.status !== 200) return this.$message.error(res.message)\r\n        this.addCateVisible = false\r\n        this.$message.info('添加分类成功')\r\n        await this.getCateList()\r\n      })\r\n    },\r\n    addCateCancel () {\r\n      this.$refs.addCateRef.resetFields()\r\n      this.addCateVisible = false\r\n      this.$message.info('新增分类已取消')\r\n    },\r\n    // 编辑用户\r\n    async editCate (id) {\r\n      this.editCateVisible = true\r\n      const { data: res } = await this.$http.get(`/category/${id}`)\r\n      if (res.status !== 200) this.$message.error(res.message)\r\n      this.cateinfo.name = res.data.name\r\n      this.cateinfo.id = id\r\n    },\r\n    editCateOk () {\r\n      this.$refs.editCateRef.validate(async (valid) => {\r\n        if (!valid) return this.$message.error('参数不符合要求，请重新输入')\r\n        const { data: res } = await this.$http.put(`cate/${this.cateinfo.id}`, {\r\n          name: this.cateinfo.name\r\n        })\r\n        if (res.status !== 200) return this.$message.error(res.message)\r\n        this.editCateVisible = false\r\n        this.$message.info('更新分类信息成功')\r\n        this.getCateList()\r\n      })\r\n    },\r\n    editCateCancel () {\r\n      this.editCateVisible = false\r\n      this.$refs.editCateRef.resetFields()\r\n      this.$message.info('编辑已取消')\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.actionSlot {\r\n    display: flex;\r\n    justify-content: center;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}