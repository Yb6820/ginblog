{"ast":null,"code":"import { Url } from '../../plugins/http';\nexport default {\n  props: ['id'],\n  data() {\n    return {\n      artInfo: {\n        id: 0,\n        title: '',\n        cid: undefined,\n        desc: '',\n        content: '',\n        img: ''\n      },\n      Catelist: [],\n      upUrl: Url + 'upload',\n      headers: {}\n    };\n  },\n  created() {\n    this.getCateList();\n    this.headers = {\n      Authorization: `Bearer ${window.sessionStorage.getItem('token')}`\n    };\n    if (this.id) {\n      this.getArtInfo(this.id);\n    }\n  },\n  methods: {\n    // 查询文章信息\n    async getArtInfo(id) {\n      const {\n        data: res\n      } = await this.$http.get(`article/${id}`);\n      if (res.status !== 200) return this.$message.error(res.message);\n      this.artInfo = res.data;\n      this.artInfo.id = res.data.ID;\n    },\n    // 获取分类列表\n    async getCateList() {\n      const {\n        data: res\n      } = await this.$http.get('categories');\n      if (res.status !== 200) return this.$message.error(res.error);\n      this.Catelist = res.data;\n    },\n    // 切换选择分类时触发\n    /* cateChange (value) {\r\n      this.artInfo.cid = value\r\n    } */\n    // 上传图片\n    upChange(info) {\n      if (info.file.status !== 'uploading') {\n        console.log(info.file, info.fileList);\n      }\n      if (info.file.status === 'done') {\n        this.$message.success('图片上传成功');\n        this.artInfo.img = info.file.response.Url;\n      } else if (info.file.status === 'error') {\n        this.$message.error('图片上传失败');\n      }\n    }\n  }\n};","map":{"version":3,"names":["Url","props","data","artInfo","id","title","cid","undefined","desc","content","img","Catelist","upUrl","headers","created","getCateList","Authorization","window","sessionStorage","getItem","getArtInfo","methods","res","$http","get","status","$message","error","message","ID","upChange","info","file","console","log","fileList","success","response"],"sources":["src/components/article/AddArt.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <h3>{{ id?'编辑文章':'新增文章' }}</h3>\r\n        <a-card>\r\n            <a-form-model :model=\"artInfo\" ref=\"artInfoRef\" :rule=\"artInfoRules\" >\r\n                <a-form-model-item label=\"文章标题\">\r\n                    <a-input style=\"width:300px\" v-model=\"artInfo.title\"></a-input>\r\n                </a-form-model-item>\r\n                <a-form-model-item label=\"文章描述\">\r\n                      <a-input type=\"textarea\" v-model=\"artInfo.desc\"></a-input>\r\n                </a-form-model-item>\r\n                <a-form-model-item label=\"文章分类\">\r\n                    <a-select style=\"width:200px\" v-model=\"artInfo.cid\" placeholder=\"请选择分类\">\r\n                        <a-select-option v-for=\"item in Catelist\" :key=\"item.id\" :value=\"item.id\">\r\n                            {{ item.name }}\r\n                        </a-select-option>\r\n                    </a-select>\r\n                </a-form-model-item>\r\n                <a-form-model-item label=\"文章缩略图\">\r\n                    <a-upload\r\n                    list-type=\"picture\"\r\n                    name=\"file\"\r\n                    :multiple=\"false\"\r\n                    :action=\"upUrl\"\r\n                    :headers=\"headers\"\r\n                    @change=\"upChange\"\r\n                    >\r\n                    <a-button> <a-icon type=\"upload\" /> 点击上传 </a-button>\r\n                    </a-upload>\r\n                </a-form-model-item>\r\n                <a-form-model-item label=\"文章内容\">\r\n                    <a-input v-model=\"artInfo.content\"></a-input>\r\n                </a-form-model-item>\r\n                <a-form-model-item>\r\n                    <a-button type=\"primary\" style=\"margin-right:15px\">提交</a-button>\r\n                    <a-button type=\"danger\">取消</a-button>\r\n                </a-form-model-item>\r\n            </a-form-model>\r\n        </a-card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { Url } from '../../plugins/http'\r\nexport default {\r\n  props: ['id'],\r\n  data () {\r\n    return {\r\n      artInfo: {\r\n        id: 0,\r\n        title: '',\r\n        cid: undefined,\r\n        desc: '',\r\n        content: '',\r\n        img: ''\r\n      },\r\n      Catelist: [],\r\n      upUrl: Url + 'upload',\r\n      headers: {}\r\n    }\r\n  },\r\n  created () {\r\n    this.getCateList()\r\n    this.headers = { Authorization: `Bearer ${window.sessionStorage.getItem('token')}` }\r\n    if (this.id) {\r\n      this.getArtInfo(this.id)\r\n    }\r\n  },\r\n  methods: {\r\n    // 查询文章信息\r\n    async getArtInfo (id) {\r\n      const { data: res } = await this.$http.get(`article/${id}`)\r\n      if (res.status !== 200) return this.$message.error(res.message)\r\n      this.artInfo = res.data\r\n      this.artInfo.id = res.data.ID\r\n    },\r\n    // 获取分类列表\r\n    async getCateList () {\r\n      const { data: res } = await this.$http.get('categories')\r\n      if (res.status !== 200) return this.$message.error(res.error)\r\n      this.Catelist = res.data\r\n    },\r\n    // 切换选择分类时触发\r\n    /* cateChange (value) {\r\n      this.artInfo.cid = value\r\n    } */\r\n    // 上传图片\r\n    upChange (info) {\r\n      if (info.file.status !== 'uploading') {\r\n        console.log(info.file, info.fileList)\r\n      }\r\n      if (info.file.status === 'done') {\r\n        this.$message.success('图片上传成功')\r\n        this.artInfo.img = info.file.response.Url\r\n      } else if (info.file.status === 'error') {\r\n        this.$message.error('图片上传失败')\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n"],"mappings":"AA2CA,SAAAA,GAAA;AACA;EACAC,KAAA;EACAC,KAAA;IACA;MACAC,OAAA;QACAC,EAAA;QACAC,KAAA;QACAC,GAAA,EAAAC,SAAA;QACAC,IAAA;QACAC,OAAA;QACAC,GAAA;MACA;MACAC,QAAA;MACAC,KAAA,EAAAZ,GAAA;MACAa,OAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,WAAA;IACA,KAAAF,OAAA;MAAAG,aAAA,YAAAC,MAAA,CAAAC,cAAA,CAAAC,OAAA;IAAA;IACA,SAAAf,EAAA;MACA,KAAAgB,UAAA,MAAAhB,EAAA;IACA;EACA;EACAiB,OAAA;IACA;IACA,MAAAD,WAAAhB,EAAA;MACA;QAAAF,IAAA,EAAAoB;MAAA,eAAAC,KAAA,CAAAC,GAAA,YAAApB,EAAA;MACA,IAAAkB,GAAA,CAAAG,MAAA,sBAAAC,QAAA,CAAAC,KAAA,CAAAL,GAAA,CAAAM,OAAA;MACA,KAAAzB,OAAA,GAAAmB,GAAA,CAAApB,IAAA;MACA,KAAAC,OAAA,CAAAC,EAAA,GAAAkB,GAAA,CAAApB,IAAA,CAAA2B,EAAA;IACA;IACA;IACA,MAAAd,YAAA;MACA;QAAAb,IAAA,EAAAoB;MAAA,eAAAC,KAAA,CAAAC,GAAA;MACA,IAAAF,GAAA,CAAAG,MAAA,sBAAAC,QAAA,CAAAC,KAAA,CAAAL,GAAA,CAAAK,KAAA;MACA,KAAAhB,QAAA,GAAAW,GAAA,CAAApB,IAAA;IACA;IACA;IACA;AACA;AACA;IACA;IACA4B,SAAAC,IAAA;MACA,IAAAA,IAAA,CAAAC,IAAA,CAAAP,MAAA;QACAQ,OAAA,CAAAC,GAAA,CAAAH,IAAA,CAAAC,IAAA,EAAAD,IAAA,CAAAI,QAAA;MACA;MACA,IAAAJ,IAAA,CAAAC,IAAA,CAAAP,MAAA;QACA,KAAAC,QAAA,CAAAU,OAAA;QACA,KAAAjC,OAAA,CAAAO,GAAA,GAAAqB,IAAA,CAAAC,IAAA,CAAAK,QAAA,CAAArC,GAAA;MACA,WAAA+B,IAAA,CAAAC,IAAA,CAAAP,MAAA;QACA,KAAAC,QAAA,CAAAC,KAAA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}