{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport day from 'dayjs';\nconst columns = [{\n  title: 'ID',\n  dataIndex: 'ID',\n  width: '5%',\n  key: 'id',\n  align: 'center'\n}, {\n  title: '更新日期',\n  dataIndex: 'UpdatedAt',\n  width: '10%',\n  key: 'UpdatedAt',\n  align: 'center',\n  customRender: val => {\n    return val ? day(val).format('YYYY年MM月DD日 HH:mm') : '暂无';\n  }\n}, {\n  title: '分类',\n  dataIndex: 'Category.name',\n  width: '5%',\n  key: 'name',\n  align: 'center'\n}, {\n  title: '文章标题',\n  dataIndex: 'title',\n  width: '15%',\n  key: 'title',\n  align: 'center'\n}, {\n  title: '文章描述',\n  dataIndex: 'desc',\n  width: '20%',\n  key: 'desc',\n  align: 'center'\n}, {\n  title: '缩略图',\n  dataIndex: 'img',\n  width: '20%',\n  key: 'img',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'img'\n  }\n}, {\n  title: '操作',\n  width: '15%',\n  key: 'action',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'action'\n  }\n}];\nexport default {\n  data() {\n    return {\n      pagination: {\n        pageSizeOptions: ['5', '10', '20'],\n        pageSize: 5,\n        total: 0,\n        showSizeChanger: true,\n        showTotal: total => `共${total}条`\n      },\n      Artlist: [],\n      Catelist: [],\n      columns,\n      queryParam: {\n        title: '',\n        pagesize: 5,\n        pagenum: 1\n      }\n    };\n  },\n  created() {\n    this.getArtList();\n    this.getCateList();\n  },\n  methods: {\n    // 获取文章列表\n    async getArtList() {\n      const {\n        data: res\n      } = await this.$http.get('admin/article', {\n        params: {\n          title: this.queryParam.title,\n          pagesize: this.queryParam.pagesize,\n          pagenum: this.queryParam.pagenum\n        }\n      });\n      if (res.status !== 200) {\n        if (res.status === (1004 || 1005 || 1006 || 1007)) {\n          window.sessionStorage.clear();\n          this.$router.push('/login');\n        }\n        this.$message.error(res.message);\n      }\n      this.Artlist = res.data;\n      this.pagination.total = res.total;\n    },\n    // 获取分类\n    async getCateList() {\n      const {\n        data: res\n      } = await this.$http.get('category');\n      if (res.status !== 200) return this.$message.error(res.message);\n      this.Catelist = res.data;\n      this.pagination.total = res.total;\n    },\n    // 更改分页\n    handleTableChange(pagination, filters, sorter) {\n      const pager = {\n        ...this.pagination\n      };\n      pager.current = pagination.current;\n      pager.pageSize = pagination.pageSize;\n      this.queryParam.pagesize = pagination.pageSize;\n      this.queryParam.pagenum = pagination.current;\n      if (pagination.pageSize !== this.pagination.pageSize) {\n        this.queryParam.pagenum = 1;\n        pager.current = 1;\n      }\n      this.pagination = pager;\n      this.getArtList();\n    },\n    // 删除文章\n    deleteArt(id) {\n      this.$confirm({\n        title: '提示：请再次确认',\n        content: '确定要删除该文章吗？一旦删除，无法恢复',\n        onOk: async () => {\n          const {\n            data: res\n          } = await this.$http.delete(`article/${id}`);\n          if (res.status != 200) return this.$message.error(res.message);\n          this.$message.success('删除成功');\n          this.getArtList();\n        },\n        onCancel: () => {\n          this.$message.info('已取消删除');\n        }\n      });\n    },\n    // 查询分类下的文章\n    CateChange(value) {\n      this.getCateArt(value);\n    },\n    async getCateArt(id) {\n      const {\n        data: res\n      } = await this.$http.get(`article/list/${id}`, {\n        params: {\n          pagesize: this.queryParam.pagesize,\n          pagenum: this.queryParam.pagenum\n        }\n      });\n      if (res.status !== 200) return this.$message.error(res.message);\n      this.Artlist = res.data;\n      this.pagination.total = res.total;\n    }\n  }\n};","map":{"version":3,"names":["day","columns","title","dataIndex","width","key","align","customRender","val","format","scopedSlots","data","pagination","pageSizeOptions","pageSize","total","showSizeChanger","showTotal","Artlist","Catelist","queryParam","pagesize","pagenum","created","getArtList","getCateList","methods","res","$http","get","params","status","window","sessionStorage","clear","$router","push","$message","error","message","handleTableChange","filters","sorter","pager","current","deleteArt","id","$confirm","content","onOk","delete","success","onCancel","info","CateChange","value","getCateArt"],"sources":["src/components/article/ArtList.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <a-card>\r\n            <a-row :gutter=\"20\">\r\n                <a-col :span=\"6\">\r\n                    <a-input-search v-model=\"queryParam.title\" placeholder=\"输入文章名查找\" enter-button allowClear\r\n                        @search=\"getArtList\" />\r\n                </a-col>\r\n                <a-col :span=\"4\">\r\n                    <a-button type=\"primary\" @click=\"$router.push('/addart')\">新增</a-button>\r\n                </a-col>\r\n\r\n                <a-col :span=\"3\">\r\n                    <a-select placeholder=\"请选择分类\" style=\"width: 200px\" @change=\"CateChange\">\r\n                        <a-select-option v-for=\"item in Catelist\" :key=\"item.id\" :value=\"item.id\">{{ item.name\r\n                        }}</a-select-option>\r\n                    </a-select>\r\n                </a-col>\r\n                <a-col :span=\"1\">\r\n                    <a-button type=\"info\" @click=\"getArtList()\">显示全部</a-button>\r\n                </a-col>\r\n            </a-row>\r\n\r\n            <a-table rowKey=\"ID\" :columns=\"columns\" :pagination=\"pagination\" :dataSource=\"Artlist\" bordered\r\n                @change=\"handleTableChange\">\r\n                <span class=\"ArtImg\" slot=\"img\" slot-scope=\"img\">\r\n                    <img :src=\"img\" />\r\n                </span>\r\n                <template slot=\"action\" slot-scope=\"data\">\r\n                    <div class=\"actionSlot\">\r\n                        <a-button size=\"small\" type=\"primary\" icon=\"edit\" style=\"margin-right: 15px\"\r\n                            @click=\"$router.push(`/addart/${data.ID}`)\">编辑</a-button>\r\n                        <a-button size=\"small\" type=\"danger\" icon=\"delete\" style=\"margin-right: 15px\"\r\n                            @click=\"deleteArt(data.ID)\">删除</a-button>\r\n                    </div>\r\n                </template>\r\n            </a-table>\r\n        </a-card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport day from 'dayjs'\r\n\r\nconst columns = [\r\n  {\r\n    title: 'ID',\r\n    dataIndex: 'ID',\r\n    width: '5%',\r\n    key: 'id',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '更新日期',\r\n    dataIndex: 'UpdatedAt',\r\n    width: '10%',\r\n    key: 'UpdatedAt',\r\n    align: 'center',\r\n    customRender: (val) => {\r\n      return val ? day(val).format('YYYY年MM月DD日 HH:mm') : '暂无'\r\n    }\r\n  },\r\n  {\r\n    title: '分类',\r\n    dataIndex: 'Category.name',\r\n    width: '5%',\r\n    key: 'name',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '文章标题',\r\n    dataIndex: 'title',\r\n    width: '15%',\r\n    key: 'title',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '文章描述',\r\n    dataIndex: 'desc',\r\n    width: '20%',\r\n    key: 'desc',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '缩略图',\r\n    dataIndex: 'img',\r\n    width: '20%',\r\n    key: 'img',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'img' }\r\n  },\r\n  {\r\n    title: '操作',\r\n    width: '15%',\r\n    key: 'action',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'action' }\r\n  }\r\n]\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      pagination: {\r\n        pageSizeOptions: ['5', '10', '20'],\r\n        pageSize: 5,\r\n        total: 0,\r\n        showSizeChanger: true,\r\n        showTotal: (total) => `共${total}条`\r\n      },\r\n      Artlist: [],\r\n      Catelist: [],\r\n      columns,\r\n      queryParam: {\r\n        title: '',\r\n        pagesize: 5,\r\n        pagenum: 1\r\n      }\r\n    }\r\n  },\r\n  created () {\r\n    this.getArtList()\r\n    this.getCateList()\r\n  },\r\n  methods: {\r\n    // 获取文章列表\r\n    async getArtList () {\r\n      const { data: res } = await this.$http.get('admin/article', {\r\n        params: {\r\n          title: this.queryParam.title,\r\n          pagesize: this.queryParam.pagesize,\r\n          pagenum: this.queryParam.pagenum\r\n        }\r\n      })\r\n      if (res.status !== 200) {\r\n        if (res.status === (1004 || 1005 || 1006 || 1007)) {\r\n          window.sessionStorage.clear()\r\n          this.$router.push('/login')\r\n        }\r\n        this.$message.error(res.message)\r\n      }\r\n\r\n      this.Artlist = res.data\r\n      this.pagination.total = res.total\r\n    },\r\n    // 获取分类\r\n    async getCateList () {\r\n      const { data: res } = await this.$http.get('category')\r\n      if (res.status !== 200) return this.$message.error(res.message)\r\n      this.Catelist = res.data\r\n      this.pagination.total = res.total\r\n    },\r\n    // 更改分页\r\n    handleTableChange (pagination, filters, sorter) {\r\n      const pager = { ...this.pagination }\r\n      pager.current = pagination.current\r\n      pager.pageSize = pagination.pageSize\r\n      this.queryParam.pagesize = pagination.pageSize\r\n      this.queryParam.pagenum = pagination.current\r\n\r\n      if (pagination.pageSize !== this.pagination.pageSize) {\r\n        this.queryParam.pagenum = 1\r\n        pager.current = 1\r\n      }\r\n      this.pagination = pager\r\n      this.getArtList()\r\n    },\r\n    // 删除文章\r\n    deleteArt (id) {\r\n      this.$confirm({\r\n        title: '提示：请再次确认',\r\n        content: '确定要删除该文章吗？一旦删除，无法恢复',\r\n        onOk: async () => {\r\n          const { data: res } = await this.$http.delete(`article/${id}`)\r\n          if (res.status != 200) return this.$message.error(res.message)\r\n          this.$message.success('删除成功')\r\n          this.getArtList()\r\n        },\r\n        onCancel: () => {\r\n          this.$message.info('已取消删除')\r\n        }\r\n      })\r\n    },\r\n    // 查询分类下的文章\r\n    CateChange (value) {\r\n      this.getCateArt(value)\r\n    },\r\n    async getCateArt (id) {\r\n      const { data: res } = await this.$http.get(`article/list/${id}`, {\r\n        params: { pagesize: this.queryParam.pagesize, pagenum: this.queryParam.pagenum }\r\n      })\r\n      if (res.status !== 200) return this.$message.error(res.message)\r\n      this.Artlist = res.data\r\n      this.pagination.total = res.total\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.actionSlot {\r\n    display: flex;\r\n    justify-content: center;\r\n}\r\n\r\n.ArtImg {\r\n    height: 100%;\r\n    width: 100%;\r\n}\r\n\r\n.ArtImg img {\r\n    width: 100px;\r\n    height: 80px;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}