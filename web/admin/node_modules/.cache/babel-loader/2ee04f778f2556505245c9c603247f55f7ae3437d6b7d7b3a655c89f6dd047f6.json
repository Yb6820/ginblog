{"ast":null,"code":"const columns = [{\n  title: 'ID',\n  dataIndex: 'ID',\n  width: '10%',\n  key: 'id',\n  align: 'center'\n}, {\n  title: '分类',\n  dataIndex: 'catename',\n  width: '20%',\n  key: 'catename',\n  align: 'center'\n}, {\n  title: '标题',\n  dataIndex: 'title',\n  width: '20%',\n  key: 'title',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'role'\n  }\n}, {\n  title: '操作',\n  width: '30%',\n  key: 'action',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'action'\n  }\n}];\nexport default {\n  data() {\n    return {\n      pagination: {\n        pageSizeOptions: ['5', '10', '20'],\n        defaultCurrent: 1,\n        defaultPageSize: 5,\n        total: 0,\n        showSizeChanger: true,\n        showTotal: total => `共${total}条`\n      },\n      artList: [],\n      columns,\n      queryParam: {\n        artname: '',\n        pagesize: 5,\n        pagenum: 1\n      },\n      newart: {\n        artname: '',\n        password: '',\n        checkpass: '',\n        role: 2\n      },\n      artinfo: {\n        id: 0,\n        artname: '',\n        role: 2\n      },\n      addArtRules: {\n        artname: [{\n          required: true,\n          message: '请输入用户名',\n          trigger: 'blur'\n        }, {\n          min: 4,\n          max: 12,\n          message: '用户名应当在4到12之间',\n          trigger: 'blur'\n        }],\n        password: [{\n          validator: (rule, value, callback) => {\n            if (value === '') {\n              callback(new Error('请输入密码'));\n            }\n            if (value.length < 6 || value.length > 20) {\n              callback(new Error('密码应当在6到20为之间'));\n            } else {\n              callback();\n            }\n          },\n          trigger: 'blur'\n        }],\n        checkpass: [{\n          validator: (rule, value, callback) => {\n            if (value === '') {\n              callback(new Error('请输入密码'));\n            }\n            if (value !== this.newart.password) {\n              callback(new Error('密码不一致，请重新输入'));\n            } else {\n              callback();\n            }\n          },\n          trigger: 'blur'\n        }]\n      },\n      editArtRules: {\n        artname: [{\n          required: true,\n          message: '请输入用户名',\n          trigger: 'blur'\n        }, {\n          min: 4,\n          max: 12,\n          message: '用户名应当在4到12之间',\n          trigger: 'blur'\n        }]\n      },\n      addArtVisible: false,\n      editArtVisible: false,\n      visible: false\n    };\n  },\n  created() {\n    this.getArtList();\n  },\n  methods: {\n    async getArtList() {\n      const {\n        data: res\n      } = await this.$http.get('arts', {\n        params: {\n          artname: this.queryParam.artname,\n          pagesize: this.queryParam.pagesize,\n          pagenum: this.queryParam.pagenum\n        }\n      });\n      if (res.status !== 200) return this.$message.error(res.message);\n      this.artList = res.data;\n      this.pagination.total = res.total;\n    },\n    // 修改分页时触发\n    handleTableChange(pagination, filters, sorter) {\n      const pager = {\n        ...this.pagination\n      };\n      pager.current = pagination.current;\n      pager.pageSize = pagination.pageSize;\n      this.queryParam.pagesize = pagination.pageSize;\n      this.queryParam.pagenum = pagination.current;\n      if (pagination.pageSize !== this.pagination.pageSize) {\n        this.queryParam.pagenum = 1;\n        pager.current = 1;\n      }\n      this.pagination = pager;\n      this.getArtList();\n    },\n    // 删除用户\n    deleteArt(id) {\n      this.$confirm({\n        title: '确定删除该用户吗？',\n        content: '一旦删除，无法恢复',\n        onOk: async () => {\n          const {\n            data: res\n          } = await this.$http.delete(`art/${id}`);\n          if (res.status !== 200) return this.$message.error(res.message);\n          this.$message.success('删除成功');\n          this.getArtList();\n        },\n        onCancel: async () => {\n          this.$message.info('已取消删除');\n        }\n      });\n    },\n    // 新增用户\n    addArtOk() {\n      this.$refs.addArtRef.validate(async valid => {\n        if (!valid) return this.$message.error('参数不符合要求，请重新输入');\n        const {\n          data: res\n        } = await this.$http.post('/art/add', {\n          artname: this.newart.artname,\n          password: this.newart.password,\n          role: this.newart.role\n        });\n        if (res.status !== 200) return this.$message.error(res.message);\n        this.addArtVisible = false;\n        this.$message.info('添加用户成功');\n        this.getArtList();\n      });\n    },\n    addArtCancel() {\n      this.$refs.addArtRef.resetFields();\n      this.addArtVisible = false;\n      this.$message.info('新增用户已取消');\n    },\n    newRoleChange(checked) {\n      this.newart.role = checked ? 1 : 2;\n    },\n    // 编辑用户\n    async editArt(id) {\n      this.editArtVisible = true;\n      const {\n        data: res\n      } = await this.$http.get(`/art/${id}`);\n      if (res.status !== 200) this.$message.error(res.message);\n      this.artinfo.artname = res.data.artname;\n      this.artinfo.role = res.data.role;\n      this.artinfo.id = id;\n    },\n    editArtOk() {\n      this.$refs.editArtRef.validate(async valid => {\n        if (!valid) return this.$message.error('参数不符合要求，请重新输入');\n        const {\n          data: res\n        } = await this.$http.put(`art/${this.artinfo.id}`, {\n          artname: this.artinfo.artname,\n          role: this.artinfo.role\n        });\n        if (res.status !== 200) return this.$message.error(res.message);\n        this.editArtVisible = false;\n        this.$message.info('编辑用户信息成功');\n        this.getArtList();\n      });\n    },\n    editRoleChange(value) {\n      this.artinfo.role = Number(value);\n    },\n    editArtCancel() {\n      this.editArtVisible = false;\n      this.$refs.editArtRef.resetFields();\n      this.$message.info('编辑已取消');\n    }\n  }\n};","map":{"version":3,"names":["columns","title","dataIndex","width","key","align","scopedSlots","customRender","data","pagination","pageSizeOptions","defaultCurrent","defaultPageSize","total","showSizeChanger","showTotal","artList","queryParam","artname","pagesize","pagenum","newart","password","checkpass","role","artinfo","id","addArtRules","required","message","trigger","min","max","validator","rule","value","callback","Error","length","editArtRules","addArtVisible","editArtVisible","visible","created","getArtList","methods","res","$http","get","params","status","$message","error","handleTableChange","filters","sorter","pager","current","pageSize","deleteArt","$confirm","content","onOk","delete","success","onCancel","info","addArtOk","$refs","addArtRef","validate","valid","post","addArtCancel","resetFields","newRoleChange","checked","editArt","editArtOk","editArtRef","put","editRoleChange","Number","editArtCancel"],"sources":["src/components/article/ArtList.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <a-card>\r\n            <a-row :gutter=\"20\">\r\n                <a-col :span=\"6\">\r\n                    <a-input-search v-model=\"queryParam.title\" placeholder=\"输入文章名查找\" enter-button allowClear\r\n                        @search=\"getArtList\" />\r\n                </a-col>\r\n                <a-col :span=\"4\">\r\n                    <a-button type=\"primary\" @click=\"addArtVisible = true\">新增</a-button>\r\n                </a-col>\r\n            </a-row>\r\n\r\n            <a-table :columns=\"columns\" :pagination='pagination' :dataSource=\"artList\" rowKey=\"ID\" bordered\r\n                @change=\"handleTableChange\">\r\n                <template slot=\"action\" slot-scope=\"data\">\r\n                    <div class=\"actionSlot\">\r\n                        <a-button type=\"primary\" icon=\"edit\" style=\"margin-right:15px\"\r\n                            @click=\"editArt(data.ID)\">编辑</a-button>\r\n                        <a-button type=\"danger\" icon=\"delete\" style=\"margin-right:15px\"\r\n                            @click=\"deleteArt(data.ID)\">删除</a-button>\r\n                    </div>\r\n                </template>\r\n            </a-table>\r\n        </a-card>\r\n</template>\r\n\r\n<script>\r\nconst columns = [\r\n  {\r\n    title: 'ID',\r\n    dataIndex: 'ID',\r\n    width: '10%',\r\n    key: 'id',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '分类',\r\n    dataIndex: 'catename',\r\n    width: '20%',\r\n    key: 'catename',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '标题',\r\n    dataIndex: 'title',\r\n    width: '20%',\r\n    key: 'title',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'role' }\r\n  },\r\n  {\r\n    title: '操作',\r\n    width: '30%',\r\n    key: 'action',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'action' }\r\n  }\r\n]\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      pagination: {\r\n        pageSizeOptions: ['5', '10', '20'],\r\n        defaultCurrent: 1,\r\n        defaultPageSize: 5,\r\n        total: 0,\r\n        showSizeChanger: true,\r\n        showTotal: (total) => `共${total}条`\r\n      },\r\n      artList: [],\r\n      columns,\r\n      queryParam: {\r\n        artname: '',\r\n        pagesize: 5,\r\n        pagenum: 1\r\n      },\r\n      newart: {\r\n        artname: '',\r\n        password: '',\r\n        checkpass: '',\r\n        role: 2\r\n      },\r\n      artinfo: {\r\n        id: 0,\r\n        artname: '',\r\n        role: 2\r\n      },\r\n      addArtRules: {\r\n        artname: [\r\n          { required: true, message: '请输入用户名', trigger: 'blur' },\r\n          { min: 4, max: 12, message: '用户名应当在4到12之间', trigger: 'blur' }\r\n        ],\r\n        password: [{\r\n          validator: (rule, value, callback) => {\r\n            if (value === '') {\r\n              callback(new Error('请输入密码'))\r\n            }\r\n            if (value.length < 6 || value.length > 20) {\r\n              callback(new Error('密码应当在6到20为之间'))\r\n            } else {\r\n              callback()\r\n            }\r\n          },\r\n          trigger: 'blur'\r\n        }],\r\n        checkpass: [{\r\n          validator: (rule, value, callback) => {\r\n            if (value === '') {\r\n              callback(new Error('请输入密码'))\r\n            }\r\n            if (value !== this.newart.password) {\r\n              callback(new Error('密码不一致，请重新输入'))\r\n            } else {\r\n              callback()\r\n            }\r\n          },\r\n          trigger: 'blur'\r\n        }]\r\n      },\r\n      editArtRules: {\r\n        artname: [\r\n          { required: true, message: '请输入用户名', trigger: 'blur' },\r\n          { min: 4, max: 12, message: '用户名应当在4到12之间', trigger: 'blur' }\r\n        ]\r\n      },\r\n      addArtVisible: false,\r\n      editArtVisible: false,\r\n      visible: false\r\n    }\r\n  },\r\n  created () {\r\n    this.getArtList()\r\n  },\r\n  methods: {\r\n    async getArtList () {\r\n      const { data: res } = await this.$http.get('arts', {\r\n        params: {\r\n          artname: this.queryParam.artname,\r\n          pagesize: this.queryParam.pagesize,\r\n          pagenum: this.queryParam.pagenum\r\n        }\r\n      })\r\n      if (res.status !== 200) return this.$message.error(res.message)\r\n      this.artList = res.data\r\n      this.pagination.total = res.total\r\n    },\r\n    // 修改分页时触发\r\n    handleTableChange (pagination, filters, sorter) {\r\n      const pager = { ...this.pagination }\r\n      pager.current = pagination.current\r\n      pager.pageSize = pagination.pageSize\r\n      this.queryParam.pagesize = pagination.pageSize\r\n      this.queryParam.pagenum = pagination.current\r\n\r\n      if (pagination.pageSize !== this.pagination.pageSize) {\r\n        this.queryParam.pagenum = 1\r\n        pager.current = 1\r\n      }\r\n      this.pagination = pager\r\n      this.getArtList()\r\n    },\r\n    // 删除用户\r\n    deleteArt (id) {\r\n      this.$confirm({\r\n        title: '确定删除该用户吗？',\r\n        content: '一旦删除，无法恢复',\r\n        onOk: async () => {\r\n          const { data: res } = await this.$http.delete(`art/${id}`)\r\n          if (res.status !== 200) return this.$message.error(res.message)\r\n          this.$message.success('删除成功')\r\n          this.getArtList()\r\n        },\r\n        onCancel: async () => {\r\n          this.$message.info('已取消删除')\r\n        }\r\n      })\r\n    },\r\n    // 新增用户\r\n    addArtOk () {\r\n      this.$refs.addArtRef.validate(async (valid) => {\r\n        if (!valid) return this.$message.error('参数不符合要求，请重新输入')\r\n        const { data: res } = await this.$http.post('/art/add', {\r\n          artname: this.newart.artname,\r\n          password: this.newart.password,\r\n          role: this.newart.role\r\n        })\r\n        if (res.status !== 200) return this.$message.error(res.message)\r\n        this.addArtVisible = false\r\n        this.$message.info('添加用户成功')\r\n        this.getArtList()\r\n      })\r\n    },\r\n    addArtCancel () {\r\n      this.$refs.addArtRef.resetFields()\r\n      this.addArtVisible = false\r\n      this.$message.info('新增用户已取消')\r\n    },\r\n    newRoleChange (checked) {\r\n      this.newart.role = checked ? 1 : 2\r\n    },\r\n    // 编辑用户\r\n    async editArt (id) {\r\n      this.editArtVisible = true\r\n      const { data: res } = await this.$http.get(`/art/${id}`)\r\n      if (res.status !== 200) this.$message.error(res.message)\r\n      this.artinfo.artname = res.data.artname\r\n      this.artinfo.role = res.data.role\r\n      this.artinfo.id = id\r\n    },\r\n    editArtOk () {\r\n      this.$refs.editArtRef.validate(async (valid) => {\r\n        if (!valid) return this.$message.error('参数不符合要求，请重新输入')\r\n        const { data: res } = await this.$http.put(`art/${this.artinfo.id}`, {\r\n          artname: this.artinfo.artname,\r\n          role: this.artinfo.role\r\n        })\r\n        if (res.status !== 200) return this.$message.error(res.message)\r\n        this.editArtVisible = false\r\n        this.$message.info('编辑用户信息成功')\r\n        this.getArtList()\r\n      })\r\n    },\r\n    editRoleChange (value) {\r\n      this.artinfo.role = Number(value)\r\n    },\r\n    editArtCancel () {\r\n      this.editArtVisible = false\r\n      this.$refs.editArtRef.resetFields()\r\n      this.$message.info('编辑已取消')\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.actionSlot {\r\n    display: flex;\r\n    justify-content: center;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}